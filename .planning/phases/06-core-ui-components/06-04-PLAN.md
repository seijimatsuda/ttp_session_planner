---
phase: 06-core-ui-components
plan: 04
type: execute
wave: 3
depends_on: ["06-01", "06-02", "06-03"]
files_modified:
  - frontend/src/App.tsx
  - frontend/src/main.tsx
autonomous: false

must_haves:
  truths:
    - "Toast notifications appear when triggered via toast() function"
    - "Error boundary catches component errors and shows recovery UI"
    - "Skeleton theme applies gray colors to all skeleton loaders"
    - "Layout adapts correctly on mobile vs desktop viewport"
  artifacts:
    - path: "frontend/src/App.tsx"
      provides: "Root app component with all providers"
      contains: "Toaster"
    - path: "frontend/src/main.tsx"
      provides: "React root with providers"
  key_links:
    - from: "frontend/src/App.tsx"
      to: "frontend/src/components/feedback/index.ts"
      via: "Toaster + AppErrorBoundary import"
      pattern: "import.*from.*components/feedback"
    - from: "frontend/src/App.tsx"
      to: "frontend/src/components/ui/index.ts"
      via: "SkeletonProvider import"
      pattern: "import.*SkeletonProvider"
    - from: "frontend/src/App.tsx"
      to: "frontend/src/components/layout/index.ts"
      via: "AppShell import"
      pattern: "import.*AppShell"
---

<objective>
Wire all UI components into the application root and verify the complete component system works.

Purpose: This is the integration step that brings all components together. The checkpoint at the end ensures the responsive layout, toast system, and all UI primitives work correctly before moving to feature development.

Output: Fully wired App.tsx with all providers, demo page showing components, human verification of responsive behavior
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-core-ui-components/06-RESEARCH.md
@.planning/phases/06-core-ui-components/06-01-SUMMARY.md
@.planning/phases/06-core-ui-components/06-02-SUMMARY.md
@.planning/phases/06-core-ui-components/06-03-SUMMARY.md

# Current app structure
@frontend/src/App.tsx
@frontend/src/main.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire providers and create component demo page</name>
  <files>
    frontend/src/App.tsx
    frontend/src/main.tsx
  </files>
  <action>
Update App.tsx to include all providers and a demo page that showcases the component library.

**App.tsx** - Complete rewrite:
```typescript
// frontend/src/App.tsx
import { useEffect, useState } from "react";
import { toast } from "sonner";

// UI Components
import { Button, Input, Skeleton, SkeletonProvider } from "./components/ui";
import { Toaster, AppErrorBoundary } from "./components/feedback";
import { AppShell, Container } from "./components/layout";

// Supabase for connection check
import { supabase } from "./lib/supabase";

/**
 * Demo sidebar content - will be replaced with real navigation later
 */
function DemoSidebar() {
  return (
    <nav className="p-4 space-y-2">
      <a
        href="#"
        className="flex items-center min-h-11 px-3 rounded-lg bg-blue-50 text-blue-700 font-medium"
      >
        Dashboard
      </a>
      <a
        href="#"
        className="flex items-center min-h-11 px-3 rounded-lg hover:bg-gray-100 text-gray-700"
      >
        Drills
      </a>
      <a
        href="#"
        className="flex items-center min-h-11 px-3 rounded-lg hover:bg-gray-100 text-gray-700"
      >
        Sessions
      </a>
    </nav>
  );
}

/**
 * Demo page showing all UI components
 * This will be replaced with routing in Phase 2 (Auth)
 */
function ComponentDemo() {
  const [connectionStatus, setConnectionStatus] = useState<"checking" | "connected" | "error">("checking");
  const [inputValue, setInputValue] = useState("");
  const [inputError, setInputError] = useState<string | undefined>();
  const [isLoading, setIsLoading] = useState(false);

  // Check Supabase connection on mount
  useEffect(() => {
    const checkConnection = async () => {
      try {
        const { error } = await supabase.auth.getSession();
        if (error) throw error;
        setConnectionStatus("connected");
      } catch (err) {
        console.error("Supabase connection error:", err);
        setConnectionStatus("error");
      }
    };
    checkConnection();
  }, []);

  // Demo form validation
  const validateInput = () => {
    if (inputValue.length < 3) {
      setInputError("Name must be at least 3 characters");
      return false;
    }
    setInputError(undefined);
    return true;
  };

  // Demo async action with toast
  const handleSave = async () => {
    if (!validateInput()) return;

    setIsLoading(true);
    try {
      // Simulate API call
      await new Promise((resolve) => setTimeout(resolve, 1500));
      toast.success(`Saved: ${inputValue}`);
      setInputValue("");
    } catch {
      toast.error("Something went wrong. Please try again.");
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <Container size="lg">
      <div className="space-y-8">
        {/* Header */}
        <div>
          <h1 className="text-3xl font-bold text-gray-900">
            Soccer Session Planner
          </h1>
          <p className="mt-2 text-gray-600">
            Component library demo - Phase 6 complete
          </p>
        </div>

        {/* Connection Status */}
        <div className="p-4 bg-white rounded-lg shadow-sm border">
          <h2 className="font-semibold text-gray-900 mb-2">Supabase Connection</h2>
          <div className="flex items-center gap-2">
            {connectionStatus === "checking" && (
              <span className="text-yellow-600">Checking...</span>
            )}
            {connectionStatus === "connected" && (
              <span className="text-green-600 font-medium">Connected</span>
            )}
            {connectionStatus === "error" && (
              <span className="text-red-600 font-medium">Error</span>
            )}
          </div>
        </div>

        {/* Button Variants */}
        <div className="p-4 bg-white rounded-lg shadow-sm border">
          <h2 className="font-semibold text-gray-900 mb-4">Button Variants</h2>
          <div className="flex flex-wrap gap-3">
            <Button variant="primary">Primary</Button>
            <Button variant="secondary">Secondary</Button>
            <Button variant="ghost">Ghost</Button>
            <Button variant="danger">Danger</Button>
            <Button loading>Loading</Button>
            <Button disabled>Disabled</Button>
          </div>
        </div>

        {/* Toast Demo */}
        <div className="p-4 bg-white rounded-lg shadow-sm border">
          <h2 className="font-semibold text-gray-900 mb-4">Toast Notifications</h2>
          <div className="flex flex-wrap gap-3">
            <Button
              variant="primary"
              onClick={() => toast.success("Success! Your action completed.")}
            >
              Success Toast
            </Button>
            <Button
              variant="danger"
              onClick={() => toast.error("Something went wrong. Please try again.")}
            >
              Error Toast
            </Button>
            <Button
              variant="secondary"
              onClick={() => toast("Info message", { description: "Additional details here" })}
            >
              Info Toast
            </Button>
          </div>
        </div>

        {/* Input Demo */}
        <div className="p-4 bg-white rounded-lg shadow-sm border">
          <h2 className="font-semibold text-gray-900 mb-4">Form Input</h2>
          <div className="max-w-md space-y-4">
            <Input
              label="Drill Name"
              placeholder="Enter drill name..."
              value={inputValue}
              onChange={(e) => setInputValue(e.target.value)}
              onBlur={validateInput}
              error={inputError}
              hint="Must be at least 3 characters"
            />
            <Button onClick={handleSave} loading={isLoading}>
              Save Drill
            </Button>
          </div>
        </div>

        {/* Skeleton Demo */}
        <div className="p-4 bg-white rounded-lg shadow-sm border">
          <h2 className="font-semibold text-gray-900 mb-4">Skeleton Loading</h2>
          <div className="flex gap-4">
            <Skeleton width={96} height={96} />
            <div className="flex-1 space-y-2">
              <Skeleton width="60%" height={24} />
              <Skeleton count={2} />
            </div>
          </div>
        </div>

        {/* Touch Target Info */}
        <div className="p-4 bg-blue-50 rounded-lg border border-blue-200">
          <h2 className="font-semibold text-blue-900 mb-2">Touch Targets</h2>
          <p className="text-blue-700 text-sm">
            All interactive elements (buttons, inputs, nav links) have a minimum 44px touch target
            for iOS/iPad accessibility compliance. Test by resizing to mobile viewport.
          </p>
        </div>
      </div>
    </Container>
  );
}

/**
 * Root App component with all providers
 */
function App() {
  return (
    <AppErrorBoundary>
      <SkeletonProvider>
        <AppShell
          sidebar={<DemoSidebar />}
          header={<span className="font-semibold">UI Component Demo</span>}
        >
          <ComponentDemo />
        </AppShell>
        <Toaster />
      </SkeletonProvider>
    </AppErrorBoundary>
  );
}

export default App;
```

**main.tsx** - No changes needed (already correct):
```typescript
// frontend/src/main.tsx
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import App from './App.tsx'
import './index.css'

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>,
)
```

**Key integration points:**
1. AppErrorBoundary wraps everything (catches any render errors)
2. SkeletonProvider applies theme to all skeletons
3. AppShell provides layout with sidebar
4. Toaster renders toast container (place after content)
5. Demo page shows all components working together
  </action>
  <verify>
1. `cd frontend && npx tsc --noEmit` - no TypeScript errors
2. `npm run dev` - app runs without errors
3. Open http://localhost:5173
4. Verify:
   - Sidebar visible on desktop
   - Click hamburger on mobile viewport - sidebar slides in
   - Click toast buttons - notifications appear bottom-right
   - Type in input, blur - validation works
   - Skeleton shows animated gray placeholder
5. `npm run build` - production build succeeds
  </verify>
  <done>
- App.tsx wired with AppErrorBoundary, SkeletonProvider, AppShell, Toaster
- Demo page shows all component variants
- Toast triggers work correctly
- Input validation shows error state
- Skeleton shows with theme colors
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete UI component library with responsive layout, toast notifications, form inputs, and skeleton loading states.
  </what-built>
  <how-to-verify>
1. **Start dev server**: `cd frontend && npm run dev`
2. **Open browser**: http://localhost:5173

**Desktop verification (viewport > 768px):**
- [ ] Sidebar visible on left side
- [ ] Main content area shows component demo
- [ ] All 6 button variants visible and styled differently
- [ ] Click "Success Toast" - green toast appears bottom-right
- [ ] Click "Error Toast" - red toast appears bottom-right
- [ ] Type "ab" in input, click elsewhere - error message shows
- [ ] Type "abc" in input, click elsewhere - error clears
- [ ] Click "Save Drill" with valid input - loading spinner shows, then success toast

**Mobile verification (resize to < 768px or use DevTools mobile view):**
- [ ] Sidebar hidden
- [ ] Hamburger menu icon visible in header
- [ ] Click hamburger - sidebar slides in from left
- [ ] Dark backdrop visible behind sidebar
- [ ] Click backdrop OR click X button - sidebar closes
- [ ] All buttons still easily tappable (44px targets)

**Skeleton verification:**
- [ ] Gray rectangle and lines visible in "Skeleton Loading" section
- [ ] Subtle animation (shimmer) on skeleton elements

**Error boundary (optional - to trigger manually):**
Add `throw new Error("test")` in ComponentDemo to verify error fallback shows "Something went wrong" message.
  </how-to-verify>
  <resume-signal>
Type "approved" if all checks pass, or describe any issues found.
  </resume-signal>
</task>

</tasks>

<verification>
Phase 6 requirements verification:
- UI-01: Responsive layout - AppShell adapts mobile/desktop (verified in checkpoint)
- UI-02: 44px touch targets - All buttons, inputs, nav links have min-h-11 (verified via grep)
- UI-03: Skeleton loading - SkeletonProvider + Skeleton component (visible in demo)
- UI-04: Toast notifications - Sonner toaster wired, toast() works (verified in checkpoint)
- UI-05: User-friendly errors - ErrorFallback shows "Something went wrong" (verified in checkpoint)
</verification>

<success_criteria>
- [ ] App.tsx has all providers wired (AppErrorBoundary, SkeletonProvider, Toaster)
- [ ] Demo page renders all component variants
- [ ] Toast notifications work when buttons clicked
- [ ] Input validation shows error/hint states
- [ ] Skeleton displays with correct theme colors
- [ ] Layout responsive - sidebar behavior differs mobile vs desktop
- [ ] Human verified mobile and desktop behavior
- [ ] TypeScript compilation passes
- [ ] Production build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/06-core-ui-components/06-04-SUMMARY.md`
</output>
